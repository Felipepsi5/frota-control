server {
  # O servidor escuta na porta 80
  listen 80;

  # Configuração para todas as rotas
  location / {
    # Define a pasta raiz onde estão os arquivos do site
    root   /usr/share/nginx/html;
    # Define o arquivo principal
    index  index.html index.htm;
    # Esta é a linha mágica:
    # Tenta encontrar o arquivo solicitado. Se não encontrar,
    # tenta encontrar uma pasta com esse nome. Se também não encontrar,
    # ele retorna o /index.html.
    try_files $uri $uri/ /index.html;
  }

  # Configuração adicional para arquivos estáticos (CSS, JS, imagens)
  location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
    try_files $uri =404;
  }

  # Configuração para API calls (se necessário)
  location /api/ {
    # Aqui você pode configurar proxy para sua API backend
    # proxy_pass http://backend:5000;
    # proxy_set_header Host $host;
    # proxy_set_header X-Real-IP $remote_addr;
    # proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    # proxy_set_header X-Forwarded-Proto $scheme;
  }

  # Configuração de segurança
  add_header X-Frame-Options "SAMEORIGIN" always;
  add_header X-Content-Type-Options "nosniff" always;
  add_header X-XSS-Protection "1; mode=block" always;
  add_header Referrer-Policy "no-referrer-when-downgrade" always;
  add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;

  # Configuração de gzip para compressão
  gzip on;
  gzip_vary on;
  gzip_min_length 1024;
  gzip_proxied expired no-cache no-store private must-revalidate auth;
  gzip_types
    text/plain
    text/css
    text/xml
    text/javascript
    application/x-javascript
    application/xml+rss
    application/javascript
    application/json;
}
